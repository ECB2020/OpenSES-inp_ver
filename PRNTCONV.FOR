      SUBROUTINE PRNTCONV
C                                                                       
C     INCLUDE                                  ( DATE: 15 AUGUST 1997 ) 
C     
      INCLUDE 'DSHARE'
      CHARACTER*132 INPUTLINE
      CHARACTER*1   PGBREAK
  10  FORMAT(A132)
  20  FORMAT (A)
  30  FORMAT(A1,A116,I6,//)
  40  FORMAT()
  50  FORMAT(//,A122)
C****
	CALL OPENPRNT
      MAXLINES=60
      NUMPAGES=1
      NUMLINES=1
      PGBREAK=CHAR(12)
C****
C**** CHECK FOR THE EXISTANCE OF THE PRINTER CONTROL FILE.  THIS FILE
C**** CONTAINS THE ESCAPE SEQUENCE FOR THE PARTICULAR PRINTER.
C**** IF FOUND, READ THE ESCAPE SEQUENCE AND PRINT IT AT THE TOP OF THE
C**** OUTPUT FILE (*.PRN).
C****
      OPEN (UNIT=5,FILE=PRNTCTRL,ERR=75)
   60 READ (UNIT=5,FMT=10,END=70)INPUTLINE
      WRITE(7,20)TRIM(INPUTLINE)
      GOTO 60
   70 CLOSE (5)
   75 WRITE(7,30)PGBREAK,HEADER,NUMPAGES
   80 READ (UNIT=6,FMT=10,END=100)INPUTLINE
C**** IF THE LINE READ IS BLANK AND THE NUMBER OF LINES WRITTEN IS 
C**** EITHER 1 OR 60, SKIP THIS LINE
      NUMY1=LEN_TRIM(INPUTLINE(1:132))
      IF ((NUMY1 .EQ. 0 .AND. NUMLINES .EQ. 1 ) .OR.
     1    (NUMY1 .EQ. 0 .AND. NUMLINES .EQ. MAXLINES)) GOTO 80
  85  IF (INPUTLINE (1:1) .NE. PGBREAK)THEN
        WRITE(7,20)TRIM(INPUTLINE)
        NUMLINES=NUMLINES+1
      ELSE
        DO 90 I=NUMLINES, MAXLINES
          WRITE (7,40)
  90    CONTINUE
        NUMLINES=MAXLINES
      ENDIF
      IF (NUMLINES .GE. MAXLINES)THEN
        NUMPAGES=NUMPAGES+1
        WRITE (7,50)FOOTER
        WRITE(7,30)PGBREAK,HEADER,NUMPAGES
        NUMLINES=1
      ENDIF
      GOTO 80
  100 CONTINUE
C**** CLOSE THE FORMATTED FILE (FILENAME.PRN) AND IF THE CONVERSION WAS
C**** COMPLETED SUCCESFULLY DELETE THE TEMPORARY FILE (FILENAME.TMP).
      CLOSE (7,ERR=110)
      CLOSE (6,STATUS='DELETE')
  110 RETURN
      END

          

